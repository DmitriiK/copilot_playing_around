<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Schulte Table</title>
  <link rel="stylesheet" href="css/schulte_table.css">
</head>
<body>
  <h1>Schulte Table, emoji edition</h1>
  <p style="max-width: 600px; margin: 0 0 10px 0; color: #444; text-align: left;"></p>
    This is a Schulte Table game with emoji icons instead of numbers. 
    Choose a category and grid size, then click Play. 
    The main grid is filled with icons, and the order to click  is shown in "Ordered items".
   Try to finish as fast as you can!
  </p>
  <div class="controls">
    <label for="category">Category:</label>
    <select id="category">
      <option value="food">Food</option>
      <option value="animal">Animal</option>
    </select>
    <label for="grid-size">Grid size:</label>
    <select id="grid-size">
      <option value="4">4 x 4</option>
      <option value="5">5 x 5</option>
      <option value="6">6 x 6</option>
    </select>
    <button id="play-btn">Play</button>
    <button id="stop-btn" disabled>Stop</button>
    <span class="timer" id="timer">00:00</span>
  </div>
  <div style="display: flex; flex-direction: column; align-items: center;">
    <div class="bordered-box" style="margin-bottom: 0;">
      <div style="font-weight:bold; margin-bottom:6px;">Ordered items</div>
      <div class="target-row" id="target-row"></div>
      <div class="next-item-name" id="next-item-name"></div>
    </div>
    <div class="bordered-box" style="margin-top: 10px;">
      <div class="grid" id="game-grid"></div>
    </div>
  </div>
  <script>
    const FOOD_EMOJIS = [
      'ðŸŽ','ðŸŒ','ðŸ‡','ðŸ‰','ðŸ“','ðŸ’','ðŸ‘','ðŸ','ðŸ¥','ðŸ…','ðŸ†','ðŸ¥‘','ðŸ¥•','ðŸŒ½','ðŸ¥¦','ðŸ¥”','ðŸ‹','ðŸŠ','ðŸ','ðŸ','ðŸ¥­','ðŸˆ','ðŸ¤','ðŸ ','ðŸ¥¬','ðŸ«›','ðŸ«‘','ðŸ§„','ðŸ§…','ðŸ¥’','ðŸ„','ðŸ¥œ','ðŸŒ°','ðŸž','ðŸ¥¨','ðŸ§€','ðŸ¥š','ðŸ¥“','ðŸ¥©','ðŸ—','ðŸ–','ðŸŒ­','ðŸ”','ðŸŸ','ðŸ•','ðŸ¥ª','ðŸ¥™','ðŸŒ®','ðŸŒ¯','ðŸ¥—','ðŸ²','ðŸ›','ðŸœ','ðŸ','ðŸ£','ðŸ±','ðŸ¥Ÿ','ðŸ¤','ðŸš','ðŸ˜','ðŸ¥','ðŸ¥ ','ðŸ¢','ðŸ¡','ðŸ§','ðŸ¨','ðŸ¦','ðŸ¥§','ðŸ°','ðŸŽ‚','ðŸ§','ðŸ®','ðŸ­','ðŸ¬','ðŸ«','ðŸ¿','ðŸ©','ðŸª'
    ];
    const ANIMAL_EMOJIS = [
      'ðŸ¶','ðŸ±','ðŸ­','ðŸ¹','ðŸ°','ðŸ¦Š','ðŸ»','ðŸ¼','ðŸ¨','ðŸ¯','ðŸ¦','ðŸ®','ðŸ·','ðŸ¸','ðŸµ','ðŸ”','ðŸ§','ðŸ¦','ðŸ¤','ðŸ¦†','ðŸ¦…','ðŸ¦‰','ðŸ¦‡','ðŸº','ðŸ—','ðŸ´','ðŸ¦„','ðŸ','ðŸ›','ðŸ¦‹','ðŸŒ','ðŸž','ðŸœ','ðŸª²','ðŸª³','ðŸ¦Ÿ','ðŸ¦—','ðŸ•·','ðŸ¦‚','ðŸ¢','ðŸ','ðŸ¦Ž','ðŸ¦–','ðŸ¦•','ðŸ™','ðŸ¦‘','ðŸ¦','ðŸ¦ž','ðŸ¦€','ðŸ¡','ðŸ ','ðŸŸ','ðŸ¬','ðŸ³','ðŸ‹','ðŸ¦ˆ','ðŸŠ','ðŸ…','ðŸ†','ðŸ¦“','ðŸ¦','ðŸ¦§','ðŸ˜','ðŸ¦£','ðŸ¦›','ðŸ¦','ðŸª','ðŸ«','ðŸ¦’','ðŸ¦˜','ðŸ¦¬','ðŸƒ','ðŸ‚','ðŸ„','ðŸŽ','ðŸ–','ðŸ','ðŸ‘','ðŸ¦™','ðŸ','ðŸ¦Œ','ðŸ•','ðŸ©','ðŸ¦®','ðŸ•â€ðŸ¦º','ðŸˆ','ðŸˆâ€â¬›','ðŸª¶','ðŸ“','ðŸ¦ƒ','ðŸ¦¤','ðŸ¦š','ðŸ¦œ','ðŸ¦¢','ðŸ¦©','ðŸ•Š','ðŸ‡','ðŸ¦','ðŸ¦¨','ðŸ¦¡','ðŸ¦«','ðŸ¦¦','ðŸ¦¥','ðŸ','ðŸ€','ðŸ¿','ðŸ¦”'
    ];

    // Mapping emoji to their English names
    const FOOD_EMOJI_NAMES = {
      'ðŸŽ': 'Apple', 'ðŸŒ': 'Banana', 'ðŸ‡': 'Grapes', 'ðŸ‰': 'Watermelon', 'ðŸ“': 'Strawberry',
      'ðŸ’': 'Cherries', 'ðŸ‘': 'Peach', 'ðŸ': 'Pineapple', 'ðŸ¥': 'Kiwi', 'ðŸ…': 'Tomato',
      'ðŸ†': 'Eggplant', 'ðŸ¥‘': 'Avocado', 'ðŸ¥•': 'Carrot', 'ðŸŒ½': 'Corn', 'ðŸ¥¦': 'Broccoli',
      'ðŸ¥”': 'Potato', 'ðŸ‹': 'Lemon', 'ðŸŠ': 'Orange', 'ðŸ': 'Pear', 'ðŸ': 'Green apple',
      'ðŸ¥­': 'Mango', 'ðŸˆ': 'Melon', 'ðŸ¤': 'Fried shrimp', 'ðŸ ': 'Sweet potato', 'ðŸ¥¬': 'Leafy green',
      'ðŸ«›': 'Pea pod', 'ðŸ«‘': 'Bell pepper', 'ðŸ§„': 'Garlic', 'ðŸ§…': 'Onion', 'ðŸ¥’': 'Cucumber',
      'ðŸ„': 'Mushroom', 'ðŸ¥œ': 'Peanuts', 'ðŸŒ°': 'Chestnut', 'ðŸž': 'Bread', 'ðŸ¥¨': 'Pretzel',
      'ðŸ§€': 'Cheese', 'ðŸ¥š': 'Egg', 'ðŸ¥“': 'Bacon', 'ðŸ¥©': 'Steak', 'ðŸ—': 'Chicken leg',
      'ðŸ–': 'Meat on bone', 'ðŸŒ­': 'Hot dog', 'ðŸ”': 'Hamburger', 'ðŸŸ': 'French fries', 'ðŸ•': 'Pizza',
      'ðŸ¥ª': 'Sandwich', 'ðŸ¥™': 'Stuffed flatbread', 'ðŸŒ®': 'Taco', 'ðŸŒ¯': 'Burrito', 'ðŸ¥—': 'Salad',
      'ðŸ²': 'Soup', 'ðŸ›': 'Curry', 'ðŸœ': 'Noodles', 'ðŸ': 'Spaghetti', 'ðŸ£': 'Sushi',
      'ðŸ±': 'Bento box', 'ðŸ¥Ÿ': 'Dumpling', 'ðŸš': 'Rice', 'ðŸ˜': 'Rice cracker',
      'ðŸ¥': 'Fish cake', 'ðŸ¥ ': 'Fortune cookie', 'ðŸ¢': 'Skewer', 'ðŸ¡': 'Dango', 'ðŸ§': 'Shaved ice',
      'ðŸ¨': 'Ice cream', 'ðŸ¦': 'Soft ice cream', 'ðŸ¥§': 'Pie', 'ðŸ°': 'Cake slice', 'ðŸŽ‚': 'Birthday cake',
      'ðŸ§': 'Cupcake', 'ðŸ®': 'Custard', 'ðŸ­': 'Lollipop', 'ðŸ¬': 'Candy', 'ðŸ«': 'Chocolate',
      'ðŸ¿': 'Popcorn', 'ðŸ©': 'Doughnut', 'ðŸª': 'Cookie'
    };

    // Mapping emoji to their Turkish names
    const FOOD_EMOJI_NAMES_TR = {
      'ðŸŽ': 'Elma', 'ðŸŒ': 'Muz', 'ðŸ‡': 'ÃœzÃ¼m', 'ðŸ‰': 'Karpuz', 'ðŸ“': 'Ã‡ilek',
      'ðŸ’': 'Kiraz', 'ðŸ‘': 'Åžeftali', 'ðŸ': 'Ananas', 'ðŸ¥': 'Kivi', 'ðŸ…': 'Domates',
      'ðŸ†': 'PatlÄ±can', 'ðŸ¥‘': 'Avokado', 'ðŸ¥•': 'HavuÃ§', 'ðŸŒ½': 'MÄ±sÄ±r', 'ðŸ¥¦': 'Brokoli',
      'ðŸ¥”': 'Patates', 'ðŸ‹': 'Limon', 'ðŸŠ': 'Portakal', 'ðŸ': 'Armut', 'ðŸ': 'YeÅŸil elma',
      'ðŸ¥­': 'Mango', 'ðŸˆ': 'Kavun', 'ðŸ¤': 'KÄ±zarmÄ±ÅŸ karides', 'ðŸ ': 'TatlÄ± patates', 'ðŸ¥¬': 'YeÅŸillik',
      'ðŸ«›': 'Bezelye', 'ðŸ«‘': 'Biber', 'ðŸ§„': 'SarÄ±msak', 'ðŸ§…': 'SoÄŸan', 'ðŸ¥’': 'SalatalÄ±k',
      'ðŸ„': 'Mantar', 'ðŸ¥œ': 'FÄ±stÄ±k', 'ðŸŒ°': 'Kestane', 'ðŸž': 'Ekmek', 'ðŸ¥¨': 'Pretzel',
      'ðŸ§€': 'Peynir', 'ðŸ¥š': 'Yumurta', 'ðŸ¥“': 'PastÄ±rma', 'ðŸ¥©': 'Biftek', 'ðŸ—': 'Tavuk butu',
      'ðŸ–': 'Et', 'ðŸŒ­': 'Sosisli', 'ðŸ”': 'Hamburger', 'ðŸŸ': 'Patates kÄ±zartmasÄ±', 'ðŸ•': 'Pizza',
      'ðŸ¥ª': 'SandviÃ§', 'ðŸ¥™': 'DÃ¼rÃ¼m', 'ðŸŒ®': 'Tako', 'ðŸŒ¯': 'Burrito', 'ðŸ¥—': 'Salata',
      'ðŸ²': 'Ã‡orba', 'ðŸ›': 'KÃ¶ri', 'ðŸœ': 'EriÅŸte', 'ðŸ': 'Spagetti', 'ðŸ£': 'SuÅŸi',
      'ðŸ±': 'Bento kutusu', 'ðŸ¥Ÿ': 'MantÄ±', 'ðŸš': 'PirinÃ§', 'ðŸ˜': 'PirinÃ§ krakeri',
      'ðŸ¥': 'BalÄ±k keki', 'ðŸ¥ ': 'Fal kurabiyesi', 'ðŸ¢': 'ÅžiÅŸ', 'ðŸ¡': 'Dango', 'ðŸ§': 'Buzlu tatlÄ±',
      'ðŸ¨': 'Dondurma', 'ðŸ¦': 'YumuÅŸak dondurma', 'ðŸ¥§': 'Turta', 'ðŸ°': 'Pasta dilimi', 'ðŸŽ‚': 'DoÄŸumgÃ¼nÃ¼ pastasÄ±',
      'ðŸ§': 'Kek', 'ðŸ®': 'Muhallebi', 'ðŸ­': 'Lolipop', 'ðŸ¬': 'Åžeker', 'ðŸ«': 'Ã‡ikolata',
      'ðŸ¿': 'PatlamÄ±ÅŸ mÄ±sÄ±r', 'ðŸ©': 'Donut', 'ðŸª': 'Kurabiye'
    };
    
    const ANIMAL_EMOJI_NAMES = {
      'ðŸ¶': 'Dog', 'ðŸ±': 'Cat', 'ðŸ­': 'Mouse', 'ðŸ¹': 'Hamster', 'ðŸ°': 'Rabbit',
      'ðŸ¦Š': 'Fox', 'ðŸ»': 'Bear', 'ðŸ¼': 'Panda', 'ðŸ¨': 'Koala', 'ðŸ¯': 'Tiger',
      'ðŸ¦': 'Lion', 'ðŸ®': 'Cow', 'ðŸ·': 'Pig', 'ðŸ¸': 'Frog', 'ðŸµ': 'Monkey',
      'ðŸ”': 'Chicken', 'ðŸ§': 'Penguin', 'ðŸ¦': 'Bird', 'ðŸ¤': 'Chick', 'ðŸ¦†': 'Duck',
      'ðŸ¦…': 'Eagle', 'ðŸ¦‰': 'Owl', 'ðŸ¦‡': 'Bat', 'ðŸº': 'Wolf', 'ðŸ—': 'Boar',
      'ðŸ´': 'Horse', 'ðŸ¦„': 'Unicorn', 'ðŸ': 'Bee', 'ðŸ›': 'Caterpillar', 'ðŸ¦‹': 'Butterfly',
      'ðŸŒ': 'Snail', 'ðŸž': 'Ladybug', 'ðŸœ': 'Ant', 'ðŸª²': 'Beetle', 'ðŸª³': 'Cockroach',
      'ðŸ¦Ÿ': 'Mosquito', 'ðŸ¦—': 'Cricket', 'ðŸ•·': 'Spider', 'ðŸ¦‚': 'Scorpion', 'ðŸ¢': 'Turtle',
      'ðŸ': 'Snake', 'ðŸ¦Ž': 'Lizard', 'ðŸ¦–': 'T-Rex', 'ðŸ¦•': 'Sauropod', 'ðŸ™': 'Octopus',
      'ðŸ¦‘': 'Squid', 'ðŸ¦': 'Shrimp', 'ðŸ¦ž': 'Lobster', 'ðŸ¦€': 'Crab', 'ðŸ¡': 'Blowfish',
      'ðŸ ': 'Tropical fish', 'ðŸŸ': 'Fish', 'ðŸ¬': 'Dolphin', 'ðŸ³': 'Whale', 'ðŸ‹': 'Whale',
      'ðŸ¦ˆ': 'Shark', 'ðŸŠ': 'Crocodile', 'ðŸ…': 'Tiger', 'ðŸ†': 'Leopard', 'ðŸ¦“': 'Zebra',
      'ðŸ¦': 'Gorilla', 'ðŸ¦§': 'Orangutan', 'ðŸ˜': 'Elephant', 'ðŸ¦£': 'Mammoth', 'ðŸ¦›': 'Hippo',
      'ðŸ¦': 'Rhino', 'ðŸª': 'Camel', 'ðŸ«': 'Two-hump camel', 'ðŸ¦’': 'Giraffe', 'ðŸ¦˜': 'Kangaroo',
      'ðŸ¦¬': 'Bison', 'ðŸƒ': 'Water buffalo', 'ðŸ‚': 'Ox', 'ðŸ„': 'Cow', 'ðŸŽ': 'Horse',
      'ðŸ–': 'Pig', 'ðŸ': 'Ram', 'ðŸ‘': 'Sheep', 'ðŸ¦™': 'Llama', 'ðŸ': 'Goat',
      'ðŸ¦Œ': 'Deer', 'ðŸ•': 'Dog', 'ðŸ©': 'Poodle', 'ðŸ¦®': 'Guide dog', 'ðŸ•â€ðŸ¦º': 'Service dog',
      'ðŸˆ': 'Cat', 'ðŸˆâ€â¬›': 'Black cat', 'ðŸª¶': 'Feather', 'ðŸ“': 'Rooster', 'ðŸ¦ƒ': 'Turkey',
      'ðŸ¦¤': 'Dodo', 'ðŸ¦š': 'Peacock', 'ðŸ¦œ': 'Parrot', 'ðŸ¦¢': 'Swan', 'ðŸ¦©': 'Flamingo',
      'ðŸ•Š': 'Dove', 'ðŸ‡': 'Rabbit', 'ðŸ¦': 'Raccoon', 'ðŸ¦¨': 'Skunk', 'ðŸ¦¡': 'Badger',
      'ðŸ¦«': 'Beaver', 'ðŸ¦¦': 'Otter', 'ðŸ¦¥': 'Sloth', 'ðŸ': 'Mouse', 'ðŸ€': 'Rat',
      'ðŸ¿': 'Chipmunk', 'ðŸ¦”': 'Hedgehog'
    };
    
    // Mapping emoji to their Turkish names
    const ANIMAL_EMOJI_NAMES_TR = {
      'ðŸ¶': 'KÃ¶pek', 'ðŸ±': 'Kedi', 'ðŸ­': 'Fare', 'ðŸ¹': 'Hamster', 'ðŸ°': 'TavÅŸan',
      'ðŸ¦Š': 'Tilki', 'ðŸ»': 'AyÄ±', 'ðŸ¼': 'Panda', 'ðŸ¨': 'Koala', 'ðŸ¯': 'Kaplan',
      'ðŸ¦': 'Aslan', 'ðŸ®': 'Ä°nek', 'ðŸ·': 'Domuz', 'ðŸ¸': 'KurbaÄŸa', 'ðŸµ': 'Maymun',
      'ðŸ”': 'Tavuk', 'ðŸ§': 'Penguen', 'ðŸ¦': 'KuÅŸ', 'ðŸ¤': 'Civciv', 'ðŸ¦†': 'Ã–rdek',
      'ðŸ¦…': 'Kartal', 'ðŸ¦‰': 'BaykuÅŸ', 'ðŸ¦‡': 'Yarasa', 'ðŸº': 'Kurt', 'ðŸ—': 'Yaban domuzu',
      'ðŸ´': 'At', 'ðŸ¦„': 'Tek boynuzlu at', 'ðŸ': 'ArÄ±', 'ðŸ›': 'TÄ±rtÄ±l', 'ðŸ¦‹': 'Kelebek',
      'ðŸŒ': 'Salyangoz', 'ðŸž': 'UÄŸur bÃ¶ceÄŸi', 'ðŸœ': 'KarÄ±nca', 'ðŸª²': 'BÃ¶cek', 'ðŸª³': 'Hamam bÃ¶ceÄŸi',
      'ðŸ¦Ÿ': 'Sivrisinek', 'ðŸ¦—': 'CÄ±rcÄ±r bÃ¶ceÄŸi', 'ðŸ•·': 'Ã–rÃ¼mcek', 'ðŸ¦‚': 'Akrep', 'ðŸ¢': 'KaplumbaÄŸa',
      'ðŸ': 'YÄ±lan', 'ðŸ¦Ž': 'Kertenkele', 'ðŸ¦–': 'T-Rex', 'ðŸ¦•': 'Sauropod', 'ðŸ™': 'Ahtapot',
      'ðŸ¦‘': 'Kalamar', 'ðŸ¦': 'Karides', 'ðŸ¦ž': 'Istakoz', 'ðŸ¦€': 'YengeÃ§', 'ðŸ¡': 'Balon balÄ±ÄŸÄ±',
      'ðŸ ': 'Tropik balÄ±k', 'ðŸŸ': 'BalÄ±k', 'ðŸ¬': 'Yunus', 'ðŸ³': 'Balina', 'ðŸ‹': 'Balina',
      'ðŸ¦ˆ': 'KÃ¶pekbalÄ±ÄŸÄ±', 'ðŸŠ': 'Timsah', 'ðŸ…': 'Kaplan', 'ðŸ†': 'Leopar', 'ðŸ¦“': 'Zebra',
      'ðŸ¦': 'Goril', 'ðŸ¦§': 'Orangutan', 'ðŸ˜': 'Fil', 'ðŸ¦£': 'Mamut', 'ðŸ¦›': 'Su aygÄ±rÄ±',
      'ðŸ¦': 'Gergedan', 'ðŸª': 'Deve', 'ðŸ«': 'Ã‡ift hÃ¶rgÃ¼Ã§lÃ¼ deve', 'ðŸ¦’': 'ZÃ¼rafa', 'ðŸ¦˜': 'Kanguru',
      'ðŸ¦¬': 'Bizon', 'ðŸƒ': 'Su mandasÄ±', 'ðŸ‚': 'Ã–kÃ¼z', 'ðŸ„': 'Ä°nek', 'ðŸŽ': 'At',
      'ðŸ–': 'Domuz', 'ðŸ': 'KoÃ§', 'ðŸ‘': 'Koyun', 'ðŸ¦™': 'Lama', 'ðŸ': 'KeÃ§i',
      'ðŸ¦Œ': 'Geyik', 'ðŸ•': 'KÃ¶pek', 'ðŸ©': 'KaniÅŸ', 'ðŸ¦®': 'Rehber kÃ¶pek', 'ðŸ•â€ðŸ¦º': 'Servis kÃ¶peÄŸi',
      'ðŸˆ': 'Kedi', 'ðŸˆâ€â¬›': 'Siyah kedi', 'ðŸª¶': 'TÃ¼y', 'ðŸ“': 'Horoz', 'ðŸ¦ƒ': 'Hindi',
      'ðŸ¦¤': 'Dodo', 'ðŸ¦š': 'Tavus kuÅŸu', 'ðŸ¦œ': 'PapaÄŸan', 'ðŸ¦¢': 'KuÄŸu', 'ðŸ¦©': 'Flamingo',
      'ðŸ•Š': 'GÃ¼vercin', 'ðŸ‡': 'TavÅŸan', 'ðŸ¦': 'Rakun', 'ðŸ¦¨': 'Kokarca', 'ðŸ¦¡': 'Porsuk',
      'ðŸ¦«': 'Kunduz', 'ðŸ¦¦': 'Su samuru', 'ðŸ¦¥': 'Tembel hayvan', 'ðŸ': 'Fare', 'ðŸ€': 'SÄ±Ã§an',
      'ðŸ¿': 'Sincap', 'ðŸ¦”': 'Kirpi'
    };
    
    let gridSize = 4;
    let order = [];
    let gridIcons = [];
    let windowSize = 4;
    let windowStart = 0;
    let playing = false;
    let timer = 0;
    let timerInterval = null;
    let currentEmojis = FOOD_EMOJIS;

    const categorySelect = document.getElementById('category');
    const gridSizeSelect = document.getElementById('grid-size');
    const playBtn = document.getElementById('play-btn');
    const stopBtn = document.getElementById('stop-btn');
    const timerEl = document.getElementById('timer');
    const targetRow = document.getElementById('target-row');
    const gameGrid = document.getElementById('game-grid');
    const nextItemName = document.getElementById('next-item-name');

    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function startGame() {
      gridSize = parseInt(gridSizeSelect.value);
      windowSize = gridSize;
      const total = gridSize * gridSize;
      currentEmojis = categorySelect.value === 'animal' ? ANIMAL_EMOJIS : FOOD_EMOJIS;
      gridIcons = shuffle(currentEmojis.slice()).slice(0, total);
      order = shuffle(gridIcons.slice());
      windowStart = 0;
      playing = true;
      timer = 0;
      updateTimer();
      playBtn.disabled = true;
      stopBtn.disabled = false;
      gridSizeSelect.disabled = true;
      categorySelect.disabled = true;
      renderTargetRow();
      renderGrid();
      updateNextItemName();
      timerInterval = setInterval(() => {
        timer++;
        updateTimer();
      }, 1000);
    }

    function stopGame() {
      playing = false;
      playBtn.disabled = false;
      stopBtn.disabled = true;
      gridSizeSelect.disabled = false;
      categorySelect.disabled = false;
      nextItemName.textContent = '';
      clearInterval(timerInterval);
    }

    function updateTimer() {
      const min = String(Math.floor(timer / 60)).padStart(2, '0');
      const sec = String(timer % 60).padStart(2, '0');
      timerEl.textContent = `${min}:${sec}`;
    }

    function updateNextItemName() {
      if (!playing || windowStart >= order.length) {
        nextItemName.textContent = '';
        return;
      }
      
      const currentEmoji = order[windowStart];
      const isAnimal = categorySelect.value === 'animal';
      const englishDict = isAnimal ? ANIMAL_EMOJI_NAMES : FOOD_EMOJI_NAMES;
      const turkishDict = isAnimal ? ANIMAL_EMOJI_NAMES_TR : FOOD_EMOJI_NAMES_TR;
      
      const englishName = englishDict[currentEmoji] || 'Unknown';
      const turkishName = turkishDict[currentEmoji] || 'Bilinmiyor';
      
      nextItemName.textContent = `${englishName} - ${turkishName}`;
    }

    function renderTargetRow() {
      targetRow.innerHTML = '';
      if (!playing) {
        // Show empty buttons before game starts
        for (let i = 0; i < windowSize; i++) {
          const btn = document.createElement('button');
          btn.className = 'target-btn';
          btn.textContent = '';
          btn.disabled = true;
          targetRow.appendChild(btn);
        }
        return;
      }
      for (let i = 0; i < windowSize; i++) {
        const idx = windowStart + i;
        if (idx < order.length) {
          const btn = document.createElement('button');
          btn.className = 'target-btn';
          btn.textContent = order[idx];
          targetRow.appendChild(btn);
        }
      }
      updateNextItemName();
    }

    function renderGrid() {
      gameGrid.innerHTML = '';
      gameGrid.style.gridTemplateColumns = `repeat(${gridSize}, 60px)`;
      gridIcons.forEach(icon => {
        const btn = document.createElement('button');
        btn.className = 'grid-btn';
        btn.textContent = icon;
        btn.disabled = !playing;
        btn.onclick = () => handleGridClick(icon, btn);
        gameGrid.appendChild(btn);
      });
    }

    function handleGridClick(icon, btn) {
      if (!playing) return;
      if (icon === order[windowStart]) {
        btn.disabled = true;
        btn.style.background = '#d0ffd0';
        windowStart++;
        renderTargetRow();
        updateNextItemName();
        // Correct finish condition: all items clicked
        if (windowStart >= order.length) {
          stopGame();
          setTimeout(() => alert(`Congratulations! Time: ${timerEl.textContent}`), 100);
        }
      } else {
        btn.classList.add('splash');
        setTimeout(() => btn.classList.remove('splash'), 350);
      }
    }

    playBtn.onclick = startGame;
    stopBtn.onclick = stopGame;
    gridSizeSelect.onchange = categorySelect.onchange = () => {
      gridSize = parseInt(gridSizeSelect.value);
      windowSize = gridSize;
      const total = gridSize * gridSize;
      currentEmojis = categorySelect.value === 'animal' ? ANIMAL_EMOJIS : FOOD_EMOJIS;
      gridIcons = shuffle(currentEmojis.slice()).slice(0, total);
      order = [];
      windowStart = 0;
      renderGrid();
      renderTargetRow();
    };
    // Initial render
    (function initialPopulate() {
      gridSize = parseInt(gridSizeSelect.value);
      windowSize = gridSize;
      const total = gridSize * gridSize;
      currentEmojis = FOOD_EMOJIS;
      gridIcons = shuffle(currentEmojis.slice()).slice(0, total);
      order = [];
      windowStart = 0;
      renderGrid();
      renderTargetRow();
    })();
  </script>
</body>
</html>
